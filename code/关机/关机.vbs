Set WshShell = WScript.CreateObject("WScript.Shell")
If WScript.Arguments.Length = 0 Then
  Set ObjShell = CreateObject("Shell.Application")
  ObjShell.ShellExecute "wscript.exe" _
    , """" & WScript.ScriptFullName & """ RunAsAdministrator", , "runas", 1
  WScript.Quit
End if



Set objShell = CreateObject("WScript.Shell")

' ????????
Dim result
result = objShell.Popup("ѡ???ػ? ?????ػ?:", 0, "MoYuWang", vbQuestion + vbYesNo)

' ???ѡ?
If result = vbYes Then
    Shutdown
ElseIf result = vbNo Then
    CancelShutdown
Else
    MsgBox "??ʱ"
End If


' ȡ??ػ?
Sub CancelShutdown()
    Dim result
    result = objShell.Run("shutdown -a", 0, True)
    ' ?????????Ľ?
    If result = 0 Then
        MsgBox "ȡ??ɹ?"
    Else
        MsgBox "ȡ?ʧ??"
    End If
End Sub


' ?ػ?
Sub Shutdown()
    Dim timeInput
    timeInput = InputBox("????ػ??????ʱ?䣨??ӣ???", "?ػ??????")
     ' ???û??????ȡ???ť
    If timeInput <> "" Then
        Dim timeMinutes
        timeMinutes = CInt(timeInput)
        
        ' ִ??ػ??????????????Ľ?
        Dim result
        result = objShell.Run ("shutdown -s -t " & timeMinutes * 60, 0, True)
        
        ' ?????????Ľ?
        If result = 0 Then
            ' ?ػ???????ɹ?
            MsgBox "?ػ??ƻ????????? " & timeMinutes & " ??Ӻ?????"
        Else
            ' ?ػ??????ʧ??
            MsgBox "?ػ??????ʧ?ܡ?"
        End If

    Else
        ' ?????ȡ???ť????ִ??ػ????
        MsgBox "ȡ??˹ػ??ƻ???"
    End If
End SUb





